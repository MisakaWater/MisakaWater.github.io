{"pages":[{"title":"","text":"//修改url的方法 //sub:数组下标 //arr:表情数组 async function setUrl(text) { if (!!(window.history && history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = text); } } //修改url为默认url async function cleanUrl(url) { if (!!(window.history && history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = url); } } function getPageHeight() { let body = document.body, html = document.documentElement; let height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight); return height; } function getWindowHeight() { let height = window.innerHeight; return height; } //循环动画使用的表情 var kaomoji = [ \"(｀･ω･)\", \"(〃∀〃)\", \"w(ﾟДﾟ)w\", \"_(:з」∠)_\" ] var emoji = [ \"🌶️\", \"💉\", \"💦\", \"🐂\", \"🍺\" ] var bar = [ \"-\", \"0\" ] var defUrl = window.location.href.split('#')[0]; //默认url var scrollProgressIntervalId = null; function scrollBarClick() { UrlProgress(bar, 0, 1, 50, -1); let e = window.event; if (e != undefined) { obj = e.target || e.srcElement; } if (e.path[0].innerText == \"click\") { e.path[0].innerText = \"stop\"; window.addEventListener('scroll', e => scrollProgress(bar), true); } else { alert(\"需要停止请刷新!\"); e.path[0].innerText = \"click\"; window.removeEventListener('scroll', scrollProgress(bar), true); } } function scrollProgress(arr) { let now; let scrollAvail = getPageHeight() - getWindowHeight(); // 可滚动的高度 let scrollTop = document.documentElement.scrollTop || document.body.scrollTop || window.pageYOffset; let length = 50; now = (scrollTop / scrollAvail) * length; now = parseInt(now); UrlProgress(arr, 0, 1, 50, now); } //arr 对应前景，背景数组 //subBack 进度条背景 //subFore 进度条前景 //length 进度条总长 //now 当前进度 function UrlProgress(arr, subBack, subFore, length, now) { let args = \"\"; for (let i = 0; i < length; i++) { args = args + arr[subBack] } if (now >= 0) { args = args.split(''); args.splice(now, 1, arr[subFore]); args = args.join(''); } setUrl(args); } //循环动画 var UrlLoopIntervalId = null; function UrlLoop(speed, arr, defUrl) { var e = window.event; if (e != undefined) { obj = e.target || e.srcElement; e.path[0].innerText = \"stop\"; } //上面: //选择触发方法的元素 if (UrlLoopIntervalId == null) { this.speed = speed || '1000'; var i = 0; UrlLoopIntervalId = setInterval(function () { setUrl(arr[i]); i++; if (i == arr.length) { i = 0; } }, speed); } else { clearInterval(UrlLoopIntervalId); cleanUrl(defUrl); UrlLoopIntervalId = null; e.path[0].innerText = \"click\"; } }","link":"/js/url.js"}],"posts":[{"title":"201906俄罗斯旅行","text":"1.第一天 2.第二天 3.第三天 4.第好多天","link":"/2019/06/26/201906俄罗斯旅行/"},{"title":"将堆栈星轨变成一段流星雨视频","text":"前言疫情期间一直在家呆着也没事做就拍拍星星前两天拍了张星轨","link":"/2020/02/19/将堆栈星轨变成一段流星雨视频/"},{"title":"JS实现URL变换","text":"前言今天无聊找东西玩翻书签翻到了http://glench.com/hash/就想着找源码搬到 blog 上，转了半天发现作者没开源，就有了下文。 演示警告！请使用无痕模式再点击下面的按钮，不然会有一堆的历史记录。表情循环:click滚动条位置动画:click 代码 ver0.2 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134//修改url的方法//sub:数组下标//arr:表情数组async function setUrl(text) { if (!!(window.history &amp;&amp; history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = text); }}//修改url为默认urlasync function cleanUrl(url) { if (!!(window.history &amp;&amp; history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = url); }}function getPageHeight() { let body = document.body, html = document.documentElement; let height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight); return height;}function getWindowHeight() { let height = window.innerHeight; return height;}//循环动画使用的表情var kaomoji = [ \"(｀･ω･)\", \"(〃∀〃)\", \"w(ﾟДﾟ)w\", \"_(:з」∠)_\"]var emoji = [ \"🌶️\", \"💉\", \"💦\", \"🐂\", \"🍺\"]var bar = [ \"-\", \"0\"]var defUrl = window.location.href.split('#')[0]; //默认urlvar scrollProgressIntervalId = null;function scrollBarClick() { UrlProgress(bar, 0, 1, 50, -1); let e = window.event; if (e != undefined) { obj = e.target || e.srcElement; } if (e.path[0].innerText == \"click\") { e.path[0].innerText = \"stop\"; window.addEventListener('scroll', e =&gt; scrollProgress(bar), true); } else { alert(\"需要停止请刷新!\"); e.path[0].innerText = \"click\"; window.removeEventListener('scroll', scrollProgress(bar), true); }}function scrollProgress(arr) { let now; let scrollAvail = getPageHeight() - getWindowHeight(); // 可滚动的高度 let scrollTop = document.documentElement.scrollTop || document.body.scrollTop || window.pageYOffset; let length = 50; now = (scrollTop / scrollAvail) * length; now = parseInt(now); UrlProgress(arr, 0, 1, 50, now);}//arr 对应前景，背景数组//subBack 进度条背景//subFore 进度条前景//length 进度条总长//now 当前进度function UrlProgress(arr, subBack, subFore, length, now) { let args = \"\"; for (let i = 0; i &lt; length; i++) { args = args + arr[subBack] } if (now &gt;= 0) { args = args.split(''); args.splice(now, 1, arr[subFore]); args = args.join(''); } setUrl(args);}//循环动画var UrlLoopIntervalId = null;function UrlLoop(speed, arr, defUrl) { var e = window.event; if (e != undefined) { obj = e.target || e.srcElement; e.path[0].innerText = \"stop\"; } //上面: //选择触发方法的元素 if (UrlLoopIntervalId == null) { this.speed = speed || '1000'; var i = 0; UrlLoopIntervalId = setInterval(function () { setUrl(arr[i]); i++; if (i == arr.length) { i = 0; } }, speed); } else { clearInterval(UrlLoopIntervalId); cleanUrl(defUrl); UrlLoopIntervalId = null; e.path[0].innerText = \"click\"; }} ver0.1 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115//修改url的方法//sub:数组下标//arr:表情数组async function setUrl(text) { if (!!(window.history &amp;&amp; history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = text); }}//修改url为默认urlasync function cleanUrl(url) { if (!!(window.history &amp;&amp; history.pushState)) { history.replaceState(null, null, window.location.href.split('#')[0] = url); }}function getPageHeight() { let body = document.body, html = document.documentElement; let height = Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight); return height;}function getWindowHeight() { let height = window.innerHeight; return height;}//循环动画使用的表情var kaomoji = [ \"(｀･ω･)\", \"(〃∀〃)\", \"w(ﾟДﾟ)w\", \"_(:з」∠)_\"]var emoji = [ \"🌶️\", \"💉\", \"💦\", \"🐂\", \"🍺\"]var bar = [ \"-\", \"0\"]var defUrl = window.location.href.split('#')[0]; //默认urlvar scrollProgressIntervalId = null;window.addEventListener('scroll', e =&gt; scrollProgress(bar), true)function scrollProgress(arr) { let now; let scrollAvail = getPageHeight() - getWindowHeight(); // 可滚动的高度 let scrollTop = document.documentElement.scrollTop || document.body.scrollTop || window.pageYOffset; let length = 50; now = (scrollTop / scrollAvail) * length; now = parseInt(now); UrlProgress(arr, 0, 1, 50, now);}//arr 对应前景，背景数组//subBack 进度条背景//subFore 进度条前景//length 进度条总长//now 当前进度function UrlProgress(arr, subBack, subFore, length, now) { let args = \"\"; for (let i = 0; i &lt; length; i++) { args = args + arr[subBack] } if (now &gt;= 0) { args = args.split(''); args.splice(now, 1, arr[subFore]); args = args.join(''); } setUrl(args);}//循环动画var UrlLoopIntervalId = null;function UrlLoop(speed, arr, defUrl) { var e = window.event; if (e != undefined) { obj = e.target || e.srcElement; e.path[0].innerText = \"stop\"; } //上面: //选择触发方法的元素 if (UrlLoopIntervalId == null) { this.speed = speed || '1000'; var i = 0; UrlLoopIntervalId = setInterval(function () { setUrl(arr[i]); i++; if (i == arr.length) { i = 0; } }, speed); } else { clearInterval(UrlLoopIntervalId); cleanUrl(defUrl); UrlLoopIntervalId = null; e.path[0].innerText = \"click\"; }} TODO [x]加一个进度条动画获取滚动位置改变进度。 [ ]同时打开多个弹窗，实现播放动画。 [ ]按钮解绑滚动条事件 [ ]在进度条的末端加进度的百分比","link":"/2019/07/21/JS实现URL变换/"}],"tags":[{"name":"旅行","slug":"旅行","link":"/tags/旅行/"},{"name":"风景","slug":"风景","link":"/tags/风景/"},{"name":"摄影","slug":"摄影","link":"/tags/摄影/"},{"name":"照片","slug":"照片","link":"/tags/照片/"},{"name":"好康的","slug":"好康的","link":"/tags/好康的/"},{"name":"js","slug":"js","link":"/tags/js/"},{"name":"动画","slug":"动画","link":"/tags/动画/"},{"name":"好玩的","slug":"好玩的","link":"/tags/好玩的/"}],"categories":[{"name":"摄影","slug":"摄影","link":"/categories/摄影/"},{"name":"编程","slug":"编程","link":"/categories/编程/"}]}